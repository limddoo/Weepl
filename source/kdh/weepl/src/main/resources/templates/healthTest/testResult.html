<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layouts/layout1}">
	
	<th:block layout:fragment="css">
		<style>
		li{
		list-style-type: none;
		
		}
		
		</style>
	
	</th:block>
	
	<th:block layout:fragment="script">
	<script>
		$(document).ready(function(){
			var val = location.href
		})
		var result_content= $("#result_content").val();
		$.ajax({
			url : "/healthTest/newResult",
			type:"POST",
			data: {
				result_cd="${cd}",
				major_div="${major_div}",
				mid_div="${mid_div}",
				minor_div="${minor_div}",
				result_content="${result_content}",
				memberCd="${memberCd}"
			},
			success:function(){
				alert("결과 등록이 완료됬습니다.");
			},
			error:function(jqXHR, status, error){
				if (jqXHR.status == '401') {
				alert("회원만 저장이 가능합니다. 저장을 하려면 로그인 또는 회원가입을 해주세요.");
				}else{
					alert(jqXHR.responseText);
				}
			}
		});
		
	</script>
	
	</th:block>
	
	<div layout:fragment="content">
	<form action="newResult" method="post" th:object="${mhTestResultDto}">
	<div class ="inner">
	<h1><strong>마음건강 검사 결과</strong></h1>
	<input type="hidden"  th:value="${cd}">
	<input type="hidden" th:value="${mid_div}">
	<h4 th:text="'검사 유형: ' + ${major_div}"></h4>
	<h3 th:text="'진행한 검사:' + ${minor_div}">  </h3>
	<input type="hidden" id="result_content" th:value="'점수:' + ${testSum} + '(' + ${totalStat} + ')'"> 
	<input type="hidden"  th:value="${memberCd}">
	
		<div id="test" class="chkResult">
		<ul>
			<li style="font-size:35px;" th:text="'총 점수: '+ ${testSum}+'점' + '('+${totalStat}+')'" ></li>
			<li th:text="${testStat}"></li>
		</ul>
		</div>
	</div>
	<div>
		<button type="submit" class="btn btn-primary">
			<span>결과 저장하기</span>
		</button>
	</div>
		<input type="hidden" th:name="${_csrf.parameterName}"
			th:value="${_csrf.token}">
	</form>
</div>

</html>